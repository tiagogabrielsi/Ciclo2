<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UFES - Matrícula Semestral</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/pages.css">
    <link rel="stylesheet" href="css/matricula.css">
</head>
<body>

    <aside class="sidebar">
        <div class="brand">
            <h1>UFES</h1>
            <p>Oi, Sofia!</p>
        </div>

        <nav class="accordion-menu">
            <div class="accordion-item">
                <button class="accordion-header" id="header-aulas">
                    <i class="fas fa-graduation-cap"></i> Minhas Aulas
                    <i class="fas fa-chevron-down arrow"></i>
                </button>
                <div class="accordion-content">
                    <a href="academico.html" class="sub-item">Acompanhamento</a>
                    <a href="curso.html" class="sub-item">Meu Curso</a>
                </div>
            </div>

            <div class="accordion-item active">
                <button class="accordion-header" id="header-matricula">
                    <i class="fas fa-calendar-check"></i> Matrícula
                    <i class="fas fa-chevron-down arrow"></i>
                </button>
                <div class="accordion-content" style="max-height: 200px;">
                    <a href="index.html" class="sub-item" style="color:#fff;">Ofertas de Disciplinas</a>
                    <a href="estagio.html" class="sub-item">Vagas de Estágio</a>
                </div>
            </div>

            <a href="documentos.html" class="nav-item">
                <i class="fas fa-file-alt"></i> Documentos
            </a>
            <a href="agenda.html" class="nav-item">
                <i class="fas fa-university"></i> Secretaria
            </a>
            
            <a href="mapa.html" class="nav-item">
                <i class="fas fa-map-marked-alt"></i> Mapa Interativo
            </a>
            <a href="cardapio.html" class="nav-item">
                <i class="fas fa-utensils"></i> Restaurante Universitário
            </a>
        </nav>
    </aside>

    <main class="main-content">
        
        <header class="top-header">
            <i class="fas fa-language icon-btn" title="Traduzir"></i>
            <i class="fas fa-sign-out-alt icon-btn" title="Sair"></i>
        </header>

        <div class="matricula-wrapper">
            
            <section class="schedule-section">
                <div class="schedule-header">
                    <h2 class="section-title" style="margin:0;">Minha Grade</h2>
                    <span style="color: #888; font-size: 14px;">
                        <i class="fas fa-square" style="color: #2ecc71;"></i> Matriculado 
                        <i class="fas fa-square" style="color: #e74c3c; margin-left:10px;"></i> Conflito
                    </span>
                </div>
                
                <div class="schedule-grid">
                    <div class="grid-header">Horário</div>
                    <div class="grid-header">SEG</div>
                    <div class="grid-header">TER</div>
                    <div class="grid-header">QUA</div>
                    <div class="grid-header">QUI</div>
                    <div class="grid-header">SEX</div>
                    <div class="grid-header">SAB</div>

                    <div class="grid-time-label">08:00</div>
                    <div class="grid-cell" data-day="seg" data-time="8"></div>
                    <div class="grid-cell" data-day="ter" data-time="8"></div>
                    <div class="grid-cell" data-day="qua" data-time="8"></div>
                    <div class="grid-cell" data-day="qui" data-time="8"></div>
                    <div class="grid-cell" data-day="sex" data-time="8"></div>
                    <div class="grid-cell" data-day="sab" data-time="8"></div>

                    <div class="grid-time-label">09:00</div>
                    <div class="grid-cell" data-day="seg" data-time="9"></div>
                    <div class="grid-cell" data-day="ter" data-time="9"></div>
                    <div class="grid-cell" data-day="qua" data-time="9"></div>
                    <div class="grid-cell" data-day="qui" data-time="9"></div>
                    <div class="grid-cell" data-day="sex" data-time="9"></div>
                    <div class="grid-cell" data-day="sab" data-time="9"></div>

                    <div class="grid-time-label">10:00</div>
                    <div class="grid-cell" data-day="seg" data-time="10"></div>
                    <div class="grid-cell" data-day="ter" data-time="10"></div>
                    <div class="grid-cell" data-day="qua" data-time="10"></div>
                    <div class="grid-cell" data-day="qui" data-time="10"></div>
                    <div class="grid-cell" data-day="sex" data-time="10"></div>
                    <div class="grid-cell" data-day="sab" data-time="10"></div>

                    <div class="grid-time-label">11:00</div>
                    <div class="grid-cell" data-day="seg" data-time="11"></div>
                    <div class="grid-cell" data-day="ter" data-time="11"></div>
                    <div class="grid-cell" data-day="qua" data-time="11"></div>
                    <div class="grid-cell" data-day="qui" data-time="11"></div>
                    <div class="grid-cell" data-day="sex" data-time="11"></div>
                    <div class="grid-cell" data-day="sab" data-time="11"></div>

                    <div class="grid-time-label">12:00</div>
                    <div class="grid-cell" data-day="seg" data-time="12"></div>
                    <div class="grid-cell" data-day="ter" data-time="12"></div>
                    <div class="grid-cell" data-day="qua" data-time="12"></div>
                    <div class="grid-cell" data-day="qui" data-time="12"></div>
                    <div class="grid-cell" data-day="sex" data-time="12"></div>
                    <div class="grid-cell" data-day="sab" data-time="12"></div>

                    <div class="grid-time-label">13:00</div>
                    <div class="grid-cell" data-day="seg" data-time="13"></div>
                    <div class="grid-cell" data-day="ter" data-time="13"></div>
                    <div class="grid-cell" data-day="qua" data-time="13"></div>
                    <div class="grid-cell" data-day="qui" data-time="13"></div>
                    <div class="grid-cell" data-day="sex" data-time="13"></div>
                    <div class="grid-cell" data-day="sab" data-time="13"></div>

                    <div class="grid-time-label">14:00</div>
                    <div class="grid-cell" data-day="seg" data-time="14"></div>
                    <div class="grid-cell" data-day="ter" data-time="14"></div>
                    <div class="grid-cell" data-day="qua" data-time="14"></div>
                    <div class="grid-cell" data-day="qui" data-time="14"></div>
                    <div class="grid-cell" data-day="sex" data-time="14"></div>
                    <div class="grid-cell" data-day="sab" data-time="14"></div>

                    <div class="grid-time-label">15:00</div>
                    <div class="grid-cell" data-day="seg" data-time="15"></div>
                    <div class="grid-cell" data-day="ter" data-time="15"></div>
                    <div class="grid-cell" data-day="qua" data-time="15"></div>
                    <div class="grid-cell" data-day="qui" data-time="15"></div>
                    <div class="grid-cell" data-day="sex" data-time="15"></div>
                    <div class="grid-cell" data-day="sab" data-time="15"></div>

                    <div class="grid-time-label">16:00</div>
                    <div class="grid-cell" data-day="seg" data-time="16"></div>
                    <div class="grid-cell" data-day="ter" data-time="16"></div>
                    <div class="grid-cell" data-day="qua" data-time="16"></div>
                    <div class="grid-cell" data-day="qui" data-time="16"></div>
                    <div class="grid-cell" data-day="sex" data-time="16"></div>
                    <div class="grid-cell" data-day="sab" data-time="16"></div>

                    <div class="grid-time-label">17:00</div>
                    <div class="grid-cell" data-day="seg" data-time="17"></div>
                    <div class="grid-cell" data-day="ter" data-time="17"></div>
                    <div class="grid-cell" data-day="qua" data-time="17"></div>
                    <div class="grid-cell" data-day="qui" data-time="17"></div>
                    <div class="grid-cell" data-day="sex" data-time="17"></div>
                    <div class="grid-cell" data-day="sab" data-time="17"></div>

                    <div class="grid-time-label">18:00</div>
                    <div class="grid-cell" data-day="seg" data-time="18"></div>
                    <div class="grid-cell" data-day="ter" data-time="18"></div>
                    <div class="grid-cell" data-day="qua" data-time="18"></div>
                    <div class="grid-cell" data-day="qui" data-time="18"></div>
                    <div class="grid-cell" data-day="sex" data-time="18"></div>
                    <div class="grid-cell" data-day="sab" data-time="18"></div>

                    <div class="grid-time-label">19:00</div>
                    <div class="grid-cell" data-day="seg" data-time="19"></div>
                    <div class="grid-cell" data-day="ter" data-time="19"></div>
                    <div class="grid-cell" data-day="qua" data-time="19"></div>
                    <div class="grid-cell" data-day="qui" data-time="19"></div>
                    <div class="grid-cell" data-day="sex" data-time="19"></div>
                    <div class="grid-cell" data-day="sab" data-time="19"></div>

                    <div class="grid-time-label">20:00</div>
                    <div class="grid-cell" data-day="seg" data-time="20"></div>
                    <div class="grid-cell" data-day="ter" data-time="20"></div>
                    <div class="grid-cell" data-day="qua" data-time="20"></div>
                    <div class="grid-cell" data-day="qui" data-time="20"></div>
                    <div class="grid-cell" data-day="sex" data-time="20"></div>
                    <div class="grid-cell" data-day="sab" data-time="20"></div>
                    
                    <div class="grid-time-label">21:00</div>
                    <div class="grid-cell" data-day="seg" data-time="21"></div>
                    <div class="grid-cell" data-day="ter" data-time="21"></div>
                    <div class="grid-cell" data-day="qua" data-time="21"></div>
                    <div class="grid-cell" data-day="qui" data-time="21"></div>
                    <div class="grid-cell" data-day="sex" data-time="21"></div>
                    <div class="grid-cell" data-day="sab" data-time="21"></div>
                    
                    <div class="grid-time-label">22:00</div>
                    <div class="grid-cell" data-day="seg" data-time="22"></div>
                    <div class="grid-cell" data-day="ter" data-time="22"></div>
                    <div class="grid-cell" data-day="qua" data-time="22"></div>
                    <div class="grid-cell" data-day="qui" data-time="22"></div>
                    <div class="grid-cell" data-day="sex" data-time="22"></div>
                    <div class="grid-cell" data-day="sab" data-time="22"></div>

                </div>
            </section>

            <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                <a href="sucesso_matricula.html" class="btn" style="background-color: #2ecc71; color: white; text-decoration: none; font-size: 18px; padding: 15px 40px; border-radius: 8px; display: flex; align-items: center; gap: 10px; transition: transform 0.2s;">
                <i class="fas fa-check-circle"></i> Confirmar Matrícula
                </a>
            </div>

            <section class="subjects-section">
                <h2 class="section-title">Disciplinas Disponíveis</h2>
                
                <div class="cards-container">
                    
                    <div class="subject-card">
                        <div class="period-badge">3º</div>
                        <div class="subject-icon"><i class="fas fa-calculator"></i></div>
                        <h3 class="subject-name">Cálculo II</h3>
                        <div class="subject-details">+Detalhes</div>
                        <button class="btn-view-classes" onclick="openModal('Cálculo II', 'calc2')">Ver Turmas</button>
                    </div>

                    <div class="subject-card">
                        <div class="period-badge">4º</div>
                        <div class="subject-icon"><i class="fas fa-network-wired"></i></div>
                        <h3 class="subject-name">Redes I</h3>
                        <div class="subject-details">+Detalhes</div>
                        <button class="btn-view-classes" onclick="openModal('Redes I', 'redes1')">Ver Turmas</button>
                    </div>

                    <div class="subject-card">
                        <div class="period-badge">2º</div>
                        <div class="subject-icon"><i class="fas fa-database"></i></div>
                        <h3 class="subject-name">Banco de Dados</h3>
                        <div class="subject-details">+Detalhes</div>
                        <button class="btn-view-classes" onclick="openModal('Banco de Dados', 'bd')">Ver Turmas</button>
                    </div>

                    <div class="subject-card">
                        <div class="period-badge">5º</div>
                        <div class="subject-icon"><i class="fas fa-robot"></i></div>
                        <h3 class="subject-name">Inteligência Art.</h3>
                        <div class="subject-details">+Detalhes</div>
                        <button class="btn-view-classes" onclick="openModal('Inteligência Art.', 'ia')">Ver Turmas</button>
                    </div>

                    <div class="subject-card">
                        <div class="period-badge" style="background-color: #9b59b6;">Opt</div>
                        <div class="subject-icon"><i class="fas fa-book-reader"></i></div>
                        <h3 class="subject-name">Lit. Russa</h3>
                        <div class="subject-details">+Detalhes</div>
                        <button class="btn-view-classes" onclick="openModal('Lit. Russa', 'lit')">Ver Turmas</button>
                    </div>

                </div>
            </section>
     
        </div>

    </main>

    <div class="modal-overlay" id="classModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalSubjectTitle">Nome da Matéria</h3>
                <button class="close-modal" onclick="closeModal()"><i class="fas fa-times"></i></button>
            </div>
            
            <table class="classes-table">
                <thead>
                    <tr>
                        <th>Turno</th>
                        <th>Curso</th>
                        <th>Horário</th>
                        <th>Ação</th>
                    </tr>
                </thead>
                <tbody id="modalTableBody">
                    </tbody>
            </table>
        </div>
    </div>

    <script src="main.js"></script>
    <script>
        const classesData = {
            'calc2': [
                { id: 'c2-t1', shift: 'morning', course: 'Eng. Computação', days: ['seg', 'qua'], timeStart: 8, timeEnd: 10 },
                { id: 'c2-t2', shift: 'afternoon', course: 'Matemática', days: ['ter', 'qui'], timeStart: 14, timeEnd: 16 }
            ],
            'redes1': [
                { id: 'r1-t1', shift: 'morning', course: 'Ciência Comp.', days: ['seg', 'qua'], timeStart: 10, timeEnd: 12 },
                { id: 'r1-t2', shift: 'night', course: 'Sist. Info', days: ['ter', 'qui'], timeStart: 19, timeEnd: 21 }
            ],
            'bd': [
                { id: 'bd-t1', shift: 'morning', course: 'Ciência Comp.', days: ['ter', 'qui'], timeStart: 8, timeEnd: 10 }
            ],
            'ia': [
                { id: 'ia-t1', shift: 'morning', course: 'Eng. Computação', days: ['seg', 'qua'], timeStart: 8, timeEnd: 10 }
            ],
            'lit': [
                { id: 'lit-t1', shift: 'morning', course: 'Letras', days: ['sex'], timeStart: 8, timeEnd: 12 }
            ]
        };

        let enrolledClasses = [];

        function openModal(subjectName, subjectKey) {
            document.getElementById('modalSubjectTitle').innerText = subjectName;
            const tbody = document.getElementById('modalTableBody');
            tbody.innerHTML = '';

            const classes = classesData[subjectKey] || [];
            
            classes.forEach(cls => {
                let shiftIcon = '';
                if(cls.shift === 'morning') shiftIcon = '<i class="fas fa-sun shift-icon shift-morning"></i> Matutino';
                else if(cls.shift === 'afternoon') shiftIcon = '<i class="fas fa-cloud-sun shift-icon shift-afternoon"></i> Vespertino';
                else shiftIcon = '<i class="fas fa-moon shift-icon shift-night"></i> Noturno';

                const daysStr = cls.days.map(d => d.toUpperCase()).join('/');
                const timeStr = `${cls.timeStart}:00 - ${cls.timeEnd}:00`;

                const isEnrolled = enrolledClasses.includes(cls.id);
                const btnText = isEnrolled ? 'Remover' : 'Adicionar';
                const btnStyle = isEnrolled ? 'background-color: #c0392b;' : '';

                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${shiftIcon}</td>
                    <td>${cls.course}</td>
                    <td>${daysStr} <br> <small style="color:#888">${timeStr}</small></td>
                    <td>
                        <button class="btn-add" style="${btnStyle}" onclick="toggleEnrollment('${cls.id}', '${subjectName}', '${subjectKey}')">
                            ${btnText}
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            document.getElementById('classModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('classModal').style.display = 'none';
        }

        function toggleEnrollment(classId, subjectName, subjectKey) {
            
            if (enrolledClasses.includes(classId)) {
                enrolledClasses = enrolledClasses.filter(id => id !== classId);
                document.querySelectorAll(`.block-${classId}`).forEach(el => el.remove());
                
                refreshGridColors();

            } else {
                enrolledClasses.push(classId);
                const cls = classesData[subjectKey].find(c => c.id === classId);
                
                cls.days.forEach(day => {
                    for(let h = cls.timeStart; h < cls.timeEnd; h++) {
                        const cell = document.querySelector(`.grid-cell[data-day="${day}"][data-time="${h}"]`);
                        if(cell) {
                            const block = document.createElement('div');
                            block.className = `class-block block-${classId} block-green`;
                            block.innerHTML = `<strong>${subjectName.substr(0, 8)}..</strong>`;
                            cell.appendChild(block);
                        }
                    }
                });

                refreshGridColors();
            }

            closeModal();
        }

        function refreshGridColors() {
            // Verificar cada célula da grade
            const cells = document.querySelectorAll('.grid-cell');
            
            cells.forEach(cell => {
                const blocks = cell.querySelectorAll('.class-block');
                
                if (blocks.length > 1) {
                    // CONFLITO!
                    blocks.forEach(b => {
                        b.classList.remove('block-green');
                        b.classList.add('block-red');
                        b.setAttribute('title', 'Conflito de Horário!');
                    });
                } else if (blocks.length === 1) {
                    // Sem conflito
                    const b = blocks[0];
                    b.classList.remove('block-red');
                    b.classList.add('block-green');
                    b.removeAttribute('title');
                }
            });
        }

        // Fechar modal ao clicar fora
        window.onclick = function(event) {
            const modal = document.getElementById('classModal');
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
